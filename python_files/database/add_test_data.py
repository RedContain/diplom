import sqlite3
import os
from datetime import datetime

# –ü—É—Ç—å –∫ –ë–î
db_path = r"C:\Users\lowar\PycharmProjects\diplom\python_files\database\database\company.db"

print(f"–î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î: {db_path}")

conn = sqlite3.connect(db_path)
cursor = conn.cursor()

# ========== 1. –§–ò–õ–ò–ê–õ–´ ==========
print("\nüè¢ –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª–∏–∞–ª—ã...")
branches = [
    ("–ì–ª–∞–≤–Ω—ã–π –∫–æ—Ä–ø—É—Å", 5, "—É–ª. –õ–µ–Ω–∏–Ω–∞, 1"),
    ("–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ ‚Ññ1", 3, "—É–ª. –ú–∏—Ä–∞, 10"),
    ("–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–ø—É—Å", 4, "—É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, 5")
]

for name, floors, address in branches:
    cursor.execute(
        "INSERT OR IGNORE INTO branches (name, floors_count, address) VALUES (?, ?, ?)",
        (name, floors, address)
    )
    print(f"  + {name}")

# ========== 2. –°–û–¢–†–£–î–ù–ò–ö–ò ==========
print("\nüë§ –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...")

# –ü–æ–ª—É—á–∞–µ–º ID —Ñ–∏–ª–∏–∞–ª–æ–≤
cursor.execute("SELECT branch_id, name FROM branches")
branch_ids = {name: bid for bid, name in cursor.fetchall()}

employees = [
    ("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "–ó–∞–≤–µ–¥—É—é—â–∏–π –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º", "2020-01-15", branch_ids.get("–ì–ª–∞–≤–Ω—ã–π –∫–æ—Ä–ø—É—Å")),
    ("–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á", "–°—Ç–∞—Ä—à–∏–π –ª–∞–±–æ—Ä–∞–Ω—Ç", "2021-03-20", branch_ids.get("–ì–ª–∞–≤–Ω—ã–π –∫–æ—Ä–ø—É—Å")),
    ("–°–∏–¥–æ—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞", "–ú–µ–¥—Å–µ—Å—Ç—Ä–∞", "2022-05-10", branch_ids.get("–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ ‚Ññ1")),
    ("–ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á", "–í—Ä–∞—á-—Ö–∏—Ä—É—Ä–≥", "2019-11-01", branch_ids.get("–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–ø—É—Å")),
    ("–°–º–∏—Ä–Ω–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞", "–ú–µ–¥—Å–µ—Å—Ç—Ä–∞", "2023-01-15", branch_ids.get("–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–ø—É—Å"))
]

for name, job, date, bid in employees:
    cursor.execute("""
                   INSERT OR IGNORE INTO employees (name_id, job_title, report_count, date_of_work, branch_id)
        VALUES (?, ?, ?, ?, ?)
                   """, (name, job, 0, date, bid))
    print(f"  + {name} - {job}")

# ========== 3. –ö–û–ú–ù–ê–¢–´ ==========
print("\nüö™ –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–Ω–∞—Ç—ã...")

rooms = [
    # –ì–ª–∞–≤–Ω—ã–π –∫–æ—Ä–ø—É—Å (branch_id = 1)
    ("101", "–ö–∞–±–∏–Ω–µ—Ç –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ", 1, 1, 5, 2, 5, 4, 25.5, 1, "–£–≥–ª–æ–≤–æ–π –∫–∞–±–∏–Ω–µ—Ç"),
    ("102", "–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è", 1, 1, 8, 1, 8, 6, 30.0, None, "–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–º–æ–Ω—Ç"),
    ("103", "–û—Ä–¥–∏–Ω–∞—Ç–æ—Ä—Å–∫–∞—è", 1, 1, 10, 3, 10, 8, 35.0, 2, ""),
    ("201", "–ü–∞–ª–∞—Ç–∞ ‚Ññ1", 1, 2, 4, 4, 4, 2, 20.0, None, ""),
    ("202", "–ü–∞–ª–∞—Ç–∞ ‚Ññ2", 1, 2, 4, 4, 4, 2, 20.0, None, ""),
    ("203", "–ü–∞–ª–∞—Ç–∞ ‚Ññ3", 1, 2, 6, 6, 6, 3, 30.0, None, ""),

    # –ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ ‚Ññ1 (branch_id = 2)
    ("1", "–ö–∞–±–∏–Ω–µ—Ç —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞", 2, 1, 6, 2, 6, 4, 22.0, 3, ""),
    ("2", "–ö–∞–±–∏–Ω–µ—Ç –ø–µ–¥–∏–∞—Ç—Ä–∞", 2, 1, 6, 2, 6, 4, 22.0, None, ""),
    ("3", "–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è", 2, 1, 8, 1, 8, 6, 28.0, None, ""),

    # –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–ø—É—Å (branch_id = 3)
    ("301", "–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è", 3, 3, 8, 2, 4, 10, 45.0, 4, "–°—Ç–µ—Ä–∏–ª—å–Ω–∞—è –∑–æ–Ω–∞"),
    ("302", "–†–µ–∞–Ω–∏–º–∞—Ü–∏—è", 3, 3, 6, 6, 6, 8, 40.0, None, "–ö–∏—Å–ª–æ—Ä–æ–¥–Ω–∞—è –ø–æ–¥–≤–æ–¥–∫–∞"),
    ("303", "–ü—Ä–µ–¥–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è", 3, 3, 4, 1, 2, 4, 20.0, None, "")
]

for room in rooms:
    cursor.execute("""
                   INSERT OR IGNORE INTO room (
            room_number, room_name, branch_id, floor, capacity,
            desks_count, chairs_count, sockets_count, area,
            responsible_employee_id, notes
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                   """, room)
    print(f"  + {room[1]} ({room[0]}) –Ω–∞ {room[3]} —ç—Ç–∞–∂–µ")

# ========== 4. –û–ë–û–†–£–î–û–í–ê–ù–ò–ï ==========
print("\nüíª –î–æ–±–∞–≤–ª—è–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ...")

# –ü–æ–ª—É—á–∞–µ–º ID –∫–æ–º–Ω–∞—Ç
cursor.execute("SELECT room_id, room_name FROM room")
room_ids = {name: rid for rid, name in cursor.fetchall()}

equipment = [
    # –ö–∞–±–∏–Ω–µ—Ç –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ
    ("–ù–æ—É—Ç–±—É–∫ HP ProBook", "–û—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞", "–ù–æ—É—Ç–±—É–∫", 1, "HP123456",
     "–û–û–û –¢–µ—Ö–Ω–∏–∫–∞", 50000, "2026-01-15", 1, "8-800-123-45-67",
     "info@tehnika.ru", "in_use", room_ids.get("–ö–∞–±–∏–Ω–µ—Ç –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ")),

    ("–ü—Ä–∏–Ω—Ç–µ—Ä Canon", "–û—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞", "–ü—Ä–∏–Ω—Ç–µ—Ä", 1, "CAN789012",
     "–û–û–û –û—Ñ–∏—Å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞", 15000, "2026-01-20", 1, "8-800-987-65-43",
     "sales@office.ru", "in_use", room_ids.get("–ö–∞–±–∏–Ω–µ—Ç –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ")),

    ("–ú–æ–Ω–∏—Ç–æ—Ä Samsung", "–û—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞", "–ú–æ–Ω–∏—Ç–æ—Ä", 2, "SAM345678",
     "–û–û–û –¢–µ—Ö–Ω–∏–∫–∞", 20000, "2026-02-01", 1, "8-800-123-45-67",
     "info@tehnika.ru", "in_use", room_ids.get("–ö–∞–±–∏–Ω–µ—Ç –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ")),

    # –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è
    ("–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ —Ñ–∞—Ä–º", "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ", "–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫", 1, "FRIDGE001",
     "–ú–µ–¥–¢–µ—Ö–Ω–∏–∫–∞", 45000, "2026-01-10", 1, "8-800-555-66-77",
     "med@teh.ru", "in_use", room_ids.get("–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è")),

    ("–°—Ç–æ–ª–∏–∫ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π", "–ú–µ–±–µ–ª—å", "–°—Ç–æ–ª", 2, "TABLE002",
     "–ú–µ–¥–ú–µ–±–µ–ª—å", 12000, "2026-01-10", 1, "8-800-555-66-78",
     "medmebel@mail.ru", "in_use", room_ids.get("–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è")),

    # –ü–∞–ª–∞—Ç–∞ ‚Ññ1
    ("–ö—Ä–æ–≤–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è", "–ú–µ–±–µ–ª—å", "–ö—Ä–æ–≤–∞—Ç—å", 4, "BED001-BED004",
     "–ú–µ–¥–ú–µ–±–µ–ª—å", 25000, "2026-01-05", 1, "8-800-555-66-78",
     "medmebel@mail.ru", "in_use", room_ids.get("–ü–∞–ª–∞—Ç–∞ ‚Ññ1")),

    ("–¢—É–º–±–æ—á–∫–∞", "–ú–µ–±–µ–ª—å", "–¢—É–º–±–∞", 4, "TUMB001-TUMB004",
     "–ú–µ–¥–ú–µ–±–µ–ª—å", 5000, "2026-01-05", 1, "8-800-555-66-78",
     "medmebel@mail.ru", "in_use", room_ids.get("–ü–∞–ª–∞—Ç–∞ ‚Ññ1"))
]

for eq in equipment:
    cursor.execute("""
                   INSERT OR IGNORE INTO equipment (
            name, category, type, quantity, serial_number,
            supplier, price, date_incoming, state_incoming,
            phone_supplier, email_supplier, status, room_id
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                   """, eq)
    print(f"  + {eq[0]}")

# ========== 5. –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ ==========
print("\nüëë –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...")
cursor.execute("""
               INSERT OR IGNORE INTO users (username, password, role)
    VALUES (?, ?, ?)
               """, ('admin', 'admin', 'admin'))

# ========== 6. –ö–û–ú–ü–ê–ù–ò–Ø ==========
print("\nüè• –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–ø–∞–Ω–∏—é...")
cursor.execute("""
               INSERT OR IGNORE INTO company (name)
    VALUES (?)
               """, ("–ì–ë–û–£ –ë–æ–ª—å–Ω–∏—Ü–∞ 2 –≥. –ê–ø—à–µ—Ä–æ–Ω—Å–∫",))

conn.commit()
conn.close()

print("\n‚úÖ –í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!")

# –ü—Ä–æ–≤–µ—Ä–∫–∞
conn = sqlite3.connect(db_path)
cursor = conn.cursor()

print("\nüìä –ò–¢–û–ì–û:")
cursor.execute("SELECT COUNT(*) FROM branches")
print(f"  –§–∏–ª–∏–∞–ª–æ–≤: {cursor.fetchone()[0]}")
cursor.execute("SELECT COUNT(*) FROM employees")
print(f"  –°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {cursor.fetchone()[0]}")
cursor.execute("SELECT COUNT(*) FROM room")
print(f"  –ö–æ–º–Ω–∞—Ç: {cursor.fetchone()[0]}")
cursor.execute("SELECT COUNT(*) FROM equipment")
print(f"  –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: {cursor.fetchone()[0]}")

conn.close()